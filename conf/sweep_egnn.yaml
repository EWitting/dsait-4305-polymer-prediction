# WandB Sweep Configuration for GAT Model
program: main.py
project: polymer-prediction  # Change this to your desired WandB project name
method: bayes  # Bayesian optimization for efficient hyperparameter search
metric:
  name: val_loss
  goal: minimize

parameters:
  # Model architecture hyperparameters - dimensions
  model.hidden_channels:
    values: 
      - [32] 
      - [64]
      - [128]
      - [256]
      - [128, 128]
      - [256, 256]
      - [64, 64, 64]
      - [128, 128, 128]
      - [64, 128, 256, 128, 64] 
      - [64, 64, 64, 64, 64]

  model.hidden_layers:
    values:
      - [16]
      - [32]
      - [64]
      - [16, 32]
      - [32, 16]
      - [32, 64]
      - [64, 128]
      - [128, 64]
  
  # GAT-specific parameters
  model.heads:
    values: [4, 8, 16, 32]
  
  model.dropout:
    distribution: uniform
    min: 0.0
    max: 0.5
  
  model.residual:
    values: [true, false]

  # Fixed parameters
  trainer.max_epochs:
    value: 50

# Fixed parameters (not swept) - keeping learning rate and batch size constant
command:
  - ${env}
  - uv
  - run
  - ${program}
  - model=gat
  - ${args_no_hyphens}

# Early termination for poor performing runs
early_terminate:
  type: hyperband
  min_iter: 3
  eta: 2
  s: 2


