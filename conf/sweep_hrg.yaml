# WandB Sweep Configuration for HRG Model
program: main.py
project: polymer-prediction  # Change this to your desired WandB project name
method: bayes  # Bayesian optimization for efficient hyperparameter search
metric:
  name: val_loss
  goal: minimize

parameters:
  # Model architecture hyperparameters
  model.hidden_dim:
    values: [32, 64, 128, 256]
  
  model.num_blocks:
    values: [2, 3, 4, 5]
  
  model.block.num_conv_layers:
    values: [1, 2, 3]
  
  model.block.num_attention_layers:
    values: [1, 2, 3]
  
  model.block.attention_heads:
    values: [4, 8, 16]
  
  model.dropout:
    distribution: uniform
    min: 0.0
    max: 0.9
  
  model.block.use_layer_norm:
    values: [true, false]

# Fixed parameters (not swept)
command:
  - ${env}
  - uv
  - run
  - ${program}
  - model=hrg
  - ${args_no_hyphens}

# Early termination for poor performing runs
early_terminate:
  type: hyperband
  min_iter: 3
  eta: 2
  s: 2

